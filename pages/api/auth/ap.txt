        await dbConnect().catch((err) => err.message);

        // check user existing
        const result = await User.findOne({
          email: credentials.email,
        });
        if (!result) throw new Error('User does not exist');

        // compare password
        const checkPassword = await compare(
          credentials.password,
          result.password
        );
        if (!checkPassword) throw new Error('Invalid credentials');

        const user = {
          name: result.username,
          email: result.email,
          image: '/favicon.ico',
        };

        return user;